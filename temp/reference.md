【リクエスト】
現在直面している具体的なエラーや問題について詳細に説明してください。問題が発生している機能、エラーメッセージ、および再現手順を含めてください。

【プロセス】
Phase #1: 詳細な調査レポート
- 関連するコードファイルの包括的な調査
- エラーの発生条件と症状の詳細分析
- 潜在的な根本原因の特定
- 現在の実装の設計上の問題点の指摘
完了条件: エラーの根本原因を特定し、詳細な分析レポートを作成

Phase #2: 問題発生の原因の特定と再現
- バックエンドでcurlやtestscriptを作成して実際の状況を再現する
- コンソールログなどを行って何が起こっているかを完全に把握する
- 問題を確実に再現できる最小限のケースを特定する
- 関連するシステムコンポーネント間の相互作用を検証する
完了条件: 問題を確実に再現する方法を確立し、その結果を文書化

Phase #3: リファクタリング/修正計画
- 必要に応じたリファクタリングの範囲決定（単一箇所の修正か全体的な再設計か）
- コードアーキテクチャの改善提案
- データフローと責任分担の最適化案
- 実装の具体的なステップバイステップガイド
完了条件: 具体的かつ実行可能な改善計画の策定

Phase #4: 実装と検証
- Before/After形式での具体的なコード変更
- 各変更の目的と期待される効果の説明
- 以下を含む包括的なテスト戦略:
  * 単体テスト（修正した関数/コンポーネント）
  * 統合テスト（関連コンポーネント間の相互作用）
  * エンドツーエンドテスト（ユーザーフロー全体）
  * エッジケースと障害シナリオの検証
完了条件: 改善策の実装と検証が完了し、問題が確実に解決されたことを確認

【設計原則】
1. シンプルさ：理解しやすく、不必要な複雑さを排除した設計。単に行数が少ないことではなく、概念的な明快さと一貫性を重視する。
2. 堅牢性：エッジケースや将来の変更に耐えられる設計。異常系への対応と障害時の適切な処理を含む。
3. 読みやすさ：他の開発者が理解しやすいコード。適切な命名、一貫したコーディングスタイル、必要に応じた明確なコメントを含む。
4. 標準的なパターン：フレームワークの推奨プラクティスに準拠し、一般的に認められたデザインパターンを活用する。
