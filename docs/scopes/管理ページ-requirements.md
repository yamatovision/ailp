# 管理ページ要件定義

## 1. 機能概要

### 目的と主な機能
- ランディングページの一元管理を行うダッシュボード
- ランディングページの作成、編集、複製、削除機能の提供
- ランディングページのステータス管理と統計情報の表示
- 効率的なLPの検索とフィルタリング機能

### 想定ユーザー
- マーケティング担当者
- コンテンツ制作者
- サイト管理者
- アナリスト

## 2. UI要素の詳細

### 各画面の構成要素
#### ヘッダー
- サービス名表示
- ヘルプボタン
- 通知ボタン（未読通知数表示）
- ユーザープロフィールアイコン

#### メインコンテンツエリア
- ページタイトルとサブタイトル
- タブ切り替え（すべて、公開中、下書き）
- 検索ボックス
- 新規LP作成ボタン
- LPカードのグリッド表示

#### LPカード
- サムネイル画像
- タイトル
- 説明文（短い抜粋）
- ステータスバッジ（下書き・公開中）
- 作成日
- コンバージョン率とデータ統計（公開中のみ）
- 操作ボタン（編集、その他メニュー）
- その他メニュー（複製、削除）

#### ダイアログ・モーダル
- 削除確認ダイアログ
- 通知スナックバー

### 入力フィールドと検証ルール
- 検索フィールド
  - 入力制限なし
  - リアルタイム検索（タイトルと説明文に対するマッチング）

### ボタンとアクション
- 新規LP作成ボタン：LP作成ページへの遷移
- 編集ボタン：該当LPの編集ページへの遷移
- 複製ボタン：現在のLPを複製して新しいドラフトLPを作成
- 削除ボタン：確認ダイアログを表示後、LPを完全に削除

## 3. データ構造

### 扱うデータの種類と形式
#### ランディングページ（LP）データ
```json
{
  "id": "数値",
  "title": "文字列（タイトル）",
  "description": "文字列（説明）",
  "status": "文字列（'draft'または'active'）",
  "thumbnail": "文字列（URL）",
  "created_at": "ISO8601形式の日時文字列",
  "conversion_rate": "数値（パーセント）",
  "views": "数値（閲覧数）",
  "conversions": "数値（コンバージョン数）"
}
```

#### ユーザープロフィールデータ
```json
{
  "id": "数値",
  "name": "文字列",
  "email": "文字列",
  "avatar": "文字列（URL）",
  "role": "文字列（権限）"
}
```

#### 通知データ
```json
{
  "id": "数値",
  "message": "文字列",
  "type": "文字列（通知タイプ）",
  "read": "真偽値",
  "created_at": "ISO8601形式の日時文字列"
}
```

### データの永続化要件
- LPデータはデータベースに保存
- 検索クエリとタブ選択の状態はURLクエリパラメータでの保持（オプション）
- 削除されたLPは完全に削除するか、別テーブルにアーカイブ（設定による）

## 4. API・バックエンド連携

### 必要なAPIエンドポイント
#### LP管理API
- `GET /api/lps` - すべてのLPを取得（フィルタリングとページネーション対応）
- `GET /api/lps/:id` - 特定のLPの詳細情報を取得
- `POST /api/lps` - 新規LP作成
- `PUT /api/lps/:id` - 既存LP更新
- `DELETE /api/lps/:id` - LP削除
- `POST /api/lps/:id/duplicate` - LP複製

#### 統計情報API
- `GET /api/lps/:id/stats` - 特定LPの詳細統計情報取得

#### 認証・ユーザーAPI
- `GET /api/user/profile` - ログインユーザーの情報取得
- `GET /api/notifications` - 通知一覧取得

### リクエスト/レスポンス形式
#### LP一覧取得
**リクエスト**:
```
GET /api/lps?status=active&page=1&limit=10&search=キャンペーン
```

**レスポンス**:
```json
{
  "data": [
    {
      "id": 1,
      "title": "SaaS製品紹介LP",
      "description": "新しいSaaS製品の紹介ランディングページ。主な機能と価格プランを紹介。",
      "status": "active",
      "thumbnail": "https://example.com/images/thumbnail1.jpg",
      "created_at": "2023-10-15T12:30:00Z",
      "conversion_rate": 3.2,
      "views": 1250,
      "conversions": 40
    },
    // 他のLP
  ],
  "meta": {
    "total": 42,
    "page": 1,
    "limit": 10,
    "totalPages": 5
  }
}
```

## 5. エラー処理

### 想定されるエラーケース
- APIリクエスト失敗
  - ネットワークエラー
  - サーバーエラー（500系）
  - 認証エラー（401/403）
  - リソース未発見（404）
- 操作エラー
  - 削除権限がない
  - すでに削除されたリソースへのアクセス
  - 同時編集によるコンフリクト

### エラーメッセージと回復方法
- ネットワークエラー: 「サーバーに接続できませんでした。インターネット接続を確認してください。」
  - 再試行ボタンを表示
- 認証エラー: 「セッションが切れました。再度ログインしてください。」
  - ログインページへのリダイレクト
- 一般的なエラー: 「操作を完了できませんでした。しばらくしてからもう一度お試しください。」
  - エラー詳細の表示（開発モードのみ）
  - ログ送信機能

## 6. パフォーマンス要件

### 応答時間の目標
- 初回ページロード: 2秒以内
- LP一覧表示: 1秒以内
- 操作（複製・削除など）の完了: 3秒以内
- 検索結果表示: 500ms以内（タイピング完了後）

### 同時接続数や負荷対策
- LP一覧のページネーション（デフォルト10件/ページ）
- API呼び出しの最適化（必要な情報のみ取得）
- 画像の最適化（サムネイル用に適切なサイズで生成・保存）
- キャッシュ利用（統計情報などの頻繁に変更されないデータ）
- サーバーサイドでの適切なインデックス設定

## 7. セキュリティ要件

### 認証・認可の方法
- JWTベースの認証システム
- ロールベースのアクセス制御（RBAC）
  - 管理者: すべての操作が可能
  - 編集者: 作成・編集・複製が可能、削除は自分が作成したものに限定
  - 閲覧者: 閲覧のみ可能、操作不可
- セッションタイムアウト（アイドル状態が続くと自動ログアウト）

### データ保護の考慮点
- すべてのAPIリクエストはHTTPS経由
- LP内の個人情報やセンシティブデータの適切な管理（マスキングなど）
- データベースの暗号化
- CSRFトークンによるクロスサイトリクエストフォージェリ対策
- 適切なContent Security Policy (CSP)の設定

## 8. 拡張性と将来の機能

### 将来追加予定の機能
- LPのバージョン管理とロールバック機能
- AI支援機能（類似LP提案、最適化提案）
- チームコラボレーション機能（コメント、承認フロー）
- 高度な分析ダッシュボード（ヒートマップ、ユーザーパス分析）
- 複数LPの同時比較機能

### 拡張性への配慮
- モジュラー設計によるコンポーネントの再利用性
- 設定駆動型UIで機能の追加・削除を容易に
- プラグインアーキテクチャによる機能拡張のサポート
- 多言語対応のための国際化（i18n）対応